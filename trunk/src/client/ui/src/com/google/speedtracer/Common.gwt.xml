<!DOCTYPE document SYSTEM
    "http://google-web-toolkit.googlecode.com/svn/releases/1.7/distro-source/core/src/gwt-module.dtd">
<module>
  <inherits name='com.google.gwt.dom.DOM' />
  <inherits name='com.google.gwt.core.Core' />
  <inherits name='com.google.gwt.animation.Animation' />
  <inherits name='com.google.gwt.resources.Resources' />
  <inherits name='com.google.gwt.uibinder.UiBinder'/>
  <inherits name='com.google.gwt.graphics.Canvas' />
  <inherits name='com.google.gwt.topspin.desktop.Desktop' />
  <inherits name='com.google.gwt.chrome.crx.Extension' />
  <inherits name='com.google.gwt.webworker.WebWorker' />

  <define-property name="speedtracer.use_mock_model" values="please, nope" />

  <define-property name="speedtracer.show_logging_ui" values="please, nope" />

  <property-provider name="speedtracer.use_mock_model"><![CDATA[
    return ($wnd.location.search.indexOf('?mock') >= 0)
        ? 'please' : 'nope';
  ]]></property-provider>

  <property-provider name="speedtracer.show_logging_ui"><![CDATA[
    // TODO (knorton): Please provide something.
    return 'nope';
  ]]></property-provider>

  <!-- TARGETING WEBKIT ONLY -->
  <set-property name='user.agent' value='safari' />

  <!-- DataModel deferred bindings. -->
  <replace-with class="com.google.speedtracer.client.model.DataModelImpl">
    <when-type-is class="com.google.speedtracer.client.model.DataModel" />
    <when-property-is name="speedtracer.use_mock_model" value="nope" />
  </replace-with>
  <replace-with class="com.google.speedtracer.client.model.MockDataModel">
    <when-type-is class="com.google.speedtracer.client.model.DataModel" />
    <when-property-is name="speedtracer.use_mock_model" value="please" />
  </replace-with>
  <replace-with class="com.google.speedtracer.client.Monitor.MockMonitor">
    <when-type-is class="com.google.speedtracer.client.Monitor" />
    <when-property-is name="speedtracer.use_mock_model" value="please" />
  </replace-with>
  <replace-with class="com.google.speedtracer.client.view.MockTestDataPanel">
    <when-type-is class="com.google.speedtracer.client.view.TestDataPanel" />
    <when-property-is name="speedtracer.use_mock_model" value="please" />
  </replace-with>
  
  <!-- Logging Ui deferred bindings. -->
  <replace-with class="com.google.speedtracer.client.Logging.NullListenerLogger">
    <when-type-is class="com.google.speedtracer.client.Logging.ListenerLogger" />
    <when-property-is name="speedtracer.show_logging_ui" value="nope" />
  </replace-with>
  <replace-with class="com.google.speedtracer.client.Logging.DebugListenerLogger">
    <when-type-is class="com.google.speedtracer.client.Logging.ListenerLogger" />
    <when-property-is name="speedtracer.show_logging_ui" value="please" />
  </replace-with>

  <!-- BuildInfo generator -->
  <generate-with class="com.google.speedtracer.generators.BuildInfoGenerator">
    <when-type-is class="com.google.speedtracer.client.BuildInfo" />
  </generate-with>
</module>
